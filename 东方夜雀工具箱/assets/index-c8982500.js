import{g as k,l as G,d as U,i as I,c as L}from"./locations-7e697ffa.js";import{d as x,r as D,c as $,o as _,a as S,b as y,e as t,w as p,f as g,u as N,g as f,h as V,i as E,F as w,t as T,_ as B,j as b,n as F}from"./index-88ca053b.js";const O={class:"divide-y pr-20px"},J=x({__name:"GuestSelect",emits:["guestSelect"],setup(m,{emit:c}){const o=D(JSON.parse(localStorage.getItem("recentGuests")??"[]")),d={children:"guests",label:"name"},l=D({type:{normal:!1,rare:!0,special:!0},asArray:!0,searchName:""});let r=$(()=>{const u=k.filter(e=>!(!l.type.normal&&e.type=="normal"||!l.type.rare&&e.type=="rare"||!l.type.special&&e.type=="special"||!e.name.includes(l.searchName)));if(l.asArray)return u;{let e={};return u.forEach(a=>(a.locations.forEach(s=>{e[s]||(e[s]=[]),e[s].push(a)}),e)),G.map(a=>({name:a,guests:e[a]})).filter(a=>{var s;return((s=a.guests)==null?void 0:s.length)??!1})}});function i(u){o.includes(u.name)?o.splice(o.indexOf(u.name),1):o.length>19&&o.pop(),o.unshift(u.name),localStorage.setItem("recentGuests",JSON.stringify(o)),o&&(u.guests||c("guestSelect",u))}function v({value:u}){i(k.find(e=>e.name===u))}return(u,e)=>{const a=f("ElAutocomplete"),s=f("ElCheckbox"),h=f("ElTree");return _(),S("div",O,[y("div",null,[t(a,{modelValue:l.searchName,"onUpdate:modelValue":e[0]||(e[0]=n=>l.searchName=n),"fetch-suggestions":(n,C)=>C(o.map(A=>({value:A}))),clearable:"",onSelect:v},null,8,["modelValue","fetch-suggestions"]),t(s,{modelValue:l.type.rare,"onUpdate:modelValue":e[1]||(e[1]=n=>l.type.rare=n)},{default:p(()=>[g("稀有")]),_:1},8,["modelValue"]),t(s,{modelValue:l.type.special,"onUpdate:modelValue":e[2]||(e[2]=n=>l.type.special=n)},{default:p(()=>[g("特殊")]),_:1},8,["modelValue"]),t(s,{modelValue:l.type.normal,"onUpdate:modelValue":e[3]||(e[3]=n=>l.type.normal=n)},{default:p(()=>[g("普通")]),_:1},8,["modelValue"]),t(s,{modelValue:l.asArray,"onUpdate:modelValue":e[4]||(e[4]=n=>l.asArray=n)},{default:p(()=>[g("平铺")]),_:1},8,["modelValue"])]),t(h,{data:N(r),props:d,onNodeClick:i},null,8,["data"])])}}}),P=x({__name:"GuestInfo",props:{guest:null},setup(m){return(c,o)=>{const d=f("ElTag"),l=f("el-descriptions-item"),r=f("el-descriptions");return _(),V(r,{title:m.guest.name},{default:p(()=>[t(l,{label:"喜好"},{default:p(()=>[(_(!0),S(w,null,E(m.guest.likedDishTraits,i=>(_(),V(d,{key:i,class:"mr-10px"},{default:p(()=>[g(T(i),1)]),_:2},1024))),128))]),_:1}),t(l,{label:"厌恶"},{default:p(()=>[(_(!0),S(w,null,E(m.guest.unlikedDishTraits,i=>(_(),V(d,{key:i,type:"danger",class:"mr-10px"},{default:p(()=>[g(T(i),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["title"])}}}),j=x({__name:"DishList",props:{dishes:null},emits:["dishSelect"],setup(m,{emit:c}){function o(d){c("dishSelect",d)}return(d,l)=>{const r=f("el-table-column"),i=f("el-table");return _(),V(i,{data:m.dishes,"header-cell-class-name":"el-header-cell",onRowClick:o},{default:p(()=>[t(r,{prop:"name",label:"菜肴"}),t(r,{prop:"cookware",label:"厨具",width:"100"}),t(r,{prop:"ingredients",label:"食材"}),t(r,{prop:"features",label:"匹配正特性"}),t(r,{prop:"missingFeatures",label:"反特性"}),t(r,{prop:"price",label:"售价",width:"80"}),t(r,{prop:"unlock",label:"解锁方式"})]),_:1},8,["data"])}}});const q=B(j,[["__scopeId","data-v-1cec3e1d"]]),z={class:"h-full flex flex-col"},M=y("h1",{class:"font-bold"},"补充特性",-1),R=y("hr",null,null,-1),H=x({__name:"IngredientList",props:{modelValue:null,ingredient:null},emits:["update:modelValue"],setup(m,{emit:c}){return(o,d)=>{const l=f("el-table-column"),r=f("el-table"),i=f("ElDrawer");return _(),V(i,{modelValue:m.modelValue,"onUpdate:modelValue":d[0]||(d[0]=v=>c("update:modelValue",v)),"with-header":!1},{default:p(()=>[y("div",z,[M,R,t(r,{data:m.ingredient,"header-cell-class-name":"el-header-cell",class:"flex-1"},{default:p(()=>[t(l,{prop:"name",label:"食材"}),t(l,{prop:"type",label:"类型",width:"80"}),t(l,{prop:"features",label:"补充特性"})]),_:1},8,["data"])])]),_:1},8,["modelValue"])}}}),K={class:"flex-1 pl-20px flex flex-col"},X=x({__name:"DishAdvice",setup(m){const c=b({}),o=b([]);d(k[0]);function d(u){c.value=u,o.value=U.reduce((e,a)=>{var h;let s=[];for(let n of a.features){if((h=c.value.unlikedDishTraits)!=null&&h.includes(n))return e;c.value.likedDishTraits.includes(n)&&s.push(n)}return s.length>0&&e.push({...a,features:s}),e},[]).sort((e,a)=>a.features.length-e.features.length)}const l=b(!1),r=b({}),i=b([]);function v(u){r.value=u,i.value=I.reduce((e,a)=>{var h;let s=[];for(let n of a.features){if((h=c.value.unlikedDishTraits)!=null&&h.includes(n))return e;c.value.likedDishTraits.includes(n)&&!r.value.features.includes(n)&&!r.value.missingFeatures.includes(n)&&s.push(n)}return s.length>0&&e.push({...a,features:s}),e},[]).sort((e,a)=>a.features.length-e.features.length),l.value=!0}return(u,e)=>{const a=f("ElScrollbar");return _(),S("div",{class:F([N(L).contentArea,"divide-x-1 flex"])},[t(a,{class:"w-200px min-w-200px"},{default:p(()=>[t(J,{onGuestSelect:e[0]||(e[0]=s=>d(s))})]),_:1}),y("div",K,[t(P,{guest:c.value},null,8,["guest"]),t(q,{dishes:o.value,class:"flex-1",onDishSelect:v},null,8,["dishes"]),t(H,{ingredient:i.value,modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value=s)},null,8,["ingredient","modelValue"])])],2)}}});export{X as default};
