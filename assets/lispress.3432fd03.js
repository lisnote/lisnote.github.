import{c as d}from"./@vue.3b8d5166.js";function n(t){return t===void 0&&(t={}),Reflect.has(t,"username")?c.username=t.username:c.username==null&&(c.username=M()),c=Object.assign(Object.assign(Object.assign({},x(c.username)),c),t),c}var c={};function x(t){return{articles:"https://api.github.com/repos/"+t+"/"+t+".github.io/contents/articles",article:"https://"+t+".github.io/articles/{title}",background:"https://"+t+".github.io/articles/assets/{title}/background.jpg",avatar:"https://avatars.githubusercontent.com/"+t}}function M(){var t,e=location.host.indexOf(".github.io");return e==-1?(console.error("Failed to obtain username,please set the username before using it."),"lisnote"):(t=location.host.substring(0,e),t)}function v(t){return fetch(n().article.replace(/\{title\}/g,t)).then(function(e){return e.text()})}function D(){return fetch(n().articles,{headers:{authorization:"Basic "+btoa(n().clientID+":"+n().clientSecret)}}).then(function(t){return t.json()}).then(function(t){return t.map(function(e){return e.name}).filter(function(e){return e!="index.html"&&e!="assets"})})}function S(){var t={};return fetch("https://api.github.com/search/code?q=date%20user:"+n().username+"%20path:articles/%20language:markdown",{headers:{Accept:"application/vnd.github.v3.text-match+json",authorization:"Basic "+btoa(n().clientID+":"+n().clientSecret)}}).then(function(e){return e.json()}).then(function(e){try{return e=e.items.filter(function(r){return!/articles\/.*\//.test(r.path)}),e.forEach(function(r){try{t[r.name]=Number(r.text_matches[0].fragment.match(/\d{4}(-\d{2}){2} \d{2}(:\d{2}){2}/)[0].replace(/-| |:/g,""))}catch{t[r.name]=0}}),t}catch{return console.error("Sort failed, API rate limit exceeded."),{}}})}var h={getArticles:D,getDateMap:S};function O(){var t,e,r=h.getArticles().then(function(i){return t=i}),f=h.getDateMap().then(function(i){return e=i});return Promise.all([r,f]).then(function(){return t.sort(function(i,g){return e[g]-e[i]}),t})}function U(t){return n().background.replace(/\{title\}/g,t)}function k(t){var e,r,f=h.getArticles().then(function(a){return e=a}),i=h.getDateMap().then(function(a){return r=a});return Promise.all([f,i]).then(function(){for(var a=[],o=[],m=function(){var l=u.value,b=v(l).then(function(A){g(t,l,A)&&o.push(l)});a.push(b)},p=d(e),u;!(u=p()).done;)m();return Promise.all(a).then(function(){return o.sort(function(s,l){return r[l]-r[s]}),o})});function g(a,o,m){for(var p=d(a),u;!(u=p()).done;){var s=u.value;if(o.indexOf(s)<0&&m.indexOf(s)<0)return!1}return!0}}function y(t){document.querySelectorAll(t).forEach(function(e){e.setAttribute("src",n().avatar)})}function T(t){document.querySelectorAll(t).forEach(function(e){e.setAttribute("href","https://github.com/"+n().username)})}function q(t){document.querySelectorAll(t).forEach(function(e){e.innerText=n().username})}var E={config:n,getArticleContent:v,getArticlesTitle:O,getBackgroundUrl:U,getSearchArticlesTitle:k,setAvatar:y,setGithubUrl:T,setUsername:q};export{E as i};
//# sourceMappingURL=lispress.3432fd03.js.map
