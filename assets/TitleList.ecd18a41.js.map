{"version":3,"file":"TitleList.ecd18a41.js","sources":["../../src/views/TitleList.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { computed, watch, ref } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport lispress from 'lispress';\r\n\r\n// 基本数据\r\nlet route = useRoute();\r\nlet page = computed(() => {\r\n  return Number(route.query.page ?? 1);\r\n});\r\nlet pageLength = 10;\r\nlet allTitles = ref<string[]>([]);\r\nlet titles = computed<string[]>(() => {\r\n  return allTitles.value.slice(\r\n    (page.value - 1) * pageLength,\r\n    page.value * pageLength,\r\n  );\r\n});\r\nlet search = computed(() => {\r\n  return route.query.search ?? '';\r\n});\r\n\r\n// 文章更新\r\nrefreshTitles();\r\nwatch(search, () => {\r\n  allTitles.value = [];\r\n  refreshTitles();\r\n});\r\nfunction refreshTitles() {\r\n  if (search.value) {\r\n    lispress\r\n      .getSearchArticlesTitle((search.value as string).split(' '))\r\n      .then((titles) => {\r\n        allTitles.value = titles;\r\n      });\r\n  } else {\r\n    lispress.getArticlesTitle().then((titles) => {\r\n      allTitles.value = titles;\r\n    });\r\n  }\r\n}\r\n\r\n// 翻页按钮逻辑\r\nfunction isShowNextPage() {\r\n  return page.value < Math.ceil(allTitles.value.length / pageLength);\r\n}\r\nlet prePage = computed(() => {\r\n  let query = {\r\n    ...route.query,\r\n  };\r\n  if (page.value == 2) {\r\n    delete query.page;\r\n  } else {\r\n    query.page = page.value - 1 + '';\r\n  }\r\n  return { query };\r\n});\r\nlet nextPage = computed(() => {\r\n  let query = {\r\n    ...route.query,\r\n  };\r\n  query.page = page.value + 1 + '';\r\n  return { query };\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div id=\"article-list\">\r\n    <router-link\r\n      v-for=\"title in titles\"\r\n      :key=\"title\"\r\n      :to=\"`/articles/?article=${title}`\"\r\n    >\r\n      <div\r\n        class=\"article-cart\"\r\n        :style=\"{\r\n          'background-image': `url(https://lisnote.github.io/articles/assets/${title}/background.jpg)`,\r\n        }\"\r\n      >\r\n        <h1>{{ title }}</h1>\r\n      </div>\r\n    </router-link>\r\n    <div class=\"page-turn\">\r\n      <router-link :to=\"prePage\" class=\"pre-page\" v-show=\"page > 1\"\r\n        >上一页</router-link\r\n      >\r\n      <router-link :to=\"nextPage\" class=\"next-page\" v-show=\"isShowNextPage()\"\r\n        >下一页</router-link\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n#article-list {\r\n  .article-cart {\r\n    margin: 1.5rem;\r\n    background: #ddd;\r\n    border-radius: 10px;\r\n    overflow: hidden;\r\n    position: relative;\r\n    // z-index: -1;\r\n    background-size: cover;\r\n    &::after {\r\n      display: block;\r\n      padding-top: 56.25%;\r\n      content: '';\r\n    }\r\n    > h1 {\r\n      position: absolute;\r\n      margin: 0;\r\n      padding: 0 10px;\r\n      width: 100%;\r\n      background: rgba(245, 245, 245, 0.85);\r\n    }\r\n  }\r\n  .page-turn {\r\n    text-align: center;\r\n    padding-bottom: 15px;\r\n    a {\r\n      margin: 15px;\r\n      text-decoration: none;\r\n      color: black;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"names":["lispress"],"mappings":"4yBAMA,GAAI,GAAQ,IACR,EAAO,EAAS,IAAM,OACxB,MAAO,QAAO,KAAM,MAAM,OAAZ,OAAoB,CAAC,CAAA,CACpC,EACG,EAAa,GACb,EAAY,EAAc,CAAA,CAAE,EAC5B,EAAS,EAAmB,IACvB,EAAU,MAAM,MACpB,GAAK,MAAQ,GAAK,EACnB,EAAK,MAAQ,CACf,CACD,EACG,EAAS,EAAS,IAAM,OACnB,MAAA,KAAM,MAAM,SAAZ,OAAsB,EAAA,CAC9B,EAGa,IACd,EAAM,EAAQ,IAAM,CAClB,EAAU,MAAQ,GACJ,GAAA,CACf,EACwB,YAAA,CACvB,AAAI,EAAO,MAENA,EAAA,uBAAwB,EAAO,MAAiB,MAAM,GAAG,CAAC,EAC1D,KAAK,AAAC,GAAW,CAChB,EAAU,MAAQ,CAAA,CACnB,EAEHA,EAAS,iBAAiB,EAAE,KAAK,AAAC,GAAW,CAC3C,EAAU,MAAQ,CAAA,CACnB,CAEL,CAG0B,YAAA,CACxB,MAAO,GAAK,MAAQ,KAAK,KAAK,EAAU,MAAM,OAAS,CAAU,CACnE,CACI,GAAA,GAAU,EAAS,IAAM,CAC3B,GAAI,GAAQ,KACP,EAAM,OAEP,MAAA,GAAK,OAAS,EAChB,MAAO,GAAM,KAEP,EAAA,KAAO,EAAK,MAAQ,EAAI,GAEzB,CAAE,OAAM,CAAA,CAChB,EACG,EAAW,EAAS,IAAM,CAC5B,GAAI,GAAQ,KACP,EAAM,OAEL,SAAA,KAAO,EAAK,MAAQ,EAAI,GACvB,CAAE,OAAM,CAAA,CAChB"}