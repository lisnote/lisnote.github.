function n(t={}){return Reflect.has(t,"username")?s.username=t.username:s.username==null&&(s.username=d()),s=Object.assign(Object.assign(Object.assign({},p(s.username)),s),t),s}let s={};function p(t){return{articles:`https://api.github.com/repos/${t}/${t}.github.io/contents/articles`,article:`https://${t}.github.io/articles/{title}`,background:`https://${t}.github.io/articles/assets/{title}/background.jpg`,avatar:`https://avatars.githubusercontent.com/${t}`}}function d(){let t,e=location.host.indexOf(".github.io");return e==-1?(console.error("Failed to obtain username,please set the username before using it."),"lisnote"):(t=location.host.substring(0,e),t)}function g(t){return fetch(n().article.replace(/\{title\}/g,t)).then(e=>e.text())}function b(){return fetch(n().articles,{headers:{authorization:"Basic "+btoa(n().clientID+":"+n().clientSecret)}}).then(t=>t.json()).then(t=>t.map(e=>e.name).filter(e=>e!="index.html"&&e!="assets"))}function A(){let t={};return fetch(`https://api.github.com/search/code?q=date%20user:${n().username}%20path:articles/%20language:markdown`,{headers:{Accept:"application/vnd.github.v3.text-match+json",authorization:"Basic "+btoa(n().clientID+":"+n().clientSecret)}}).then(e=>e.json()).then(e=>{try{return e=e.items.filter(r=>!/articles\/.*\//.test(r.path)),e.forEach(r=>{try{t[r.name]=Number(r.text_matches[0].fragment.match(/\d{4}(-\d{2}){2} \d{2}(:\d{2}){2}/)[0].replace(/-| |:/g,""))}catch{t[r.name]=0}}),t}catch{return console.error("Sort failed, API rate limit exceeded."),{}}})}var h={getArticles:b,getDateMap:A};function x(){let t,e,r=h.getArticles().then(i=>t=i),u=h.getDateMap().then(i=>e=i);return Promise.all([r,u]).then(()=>(t.sort((i,f)=>e[f]-e[i]),t))}function v(t){return n().background.replace(/\{title\}/g,t)}function M(t){let e,r,u=h.getArticles().then(a=>e=a),i=h.getDateMap().then(a=>r=a);return Promise.all([u,i]).then(()=>{let a=[],o=[];for(let c of e){let l=g(c).then(m=>{f(t,c,m)&&o.push(c)});a.push(l)}return Promise.all(a).then(()=>(o.sort((c,l)=>r[l]-r[c]),o))});function f(a,o,c){for(let l of a)if(o.indexOf(l)<0&&c.indexOf(l)<0)return!1;return!0}}function $(t){document.querySelectorAll(t).forEach(e=>{e.setAttribute("src",n().avatar)})}function y(t){document.querySelectorAll(t).forEach(e=>{e.setAttribute("href",`https://github.com/${n().username}`)})}function D(t){document.querySelectorAll(t).forEach(e=>{e.innerText=n().username})}var S={config:n,getArticleContent:g,getArticlesTitle:x,getBackgroundUrl:v,getSearchArticlesTitle:M,setAvatar:$,setGithubUrl:y,setUsername:D};export{S as i};
